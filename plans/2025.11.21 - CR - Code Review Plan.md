# Code Review Plan (2025-11-21)

Scope: mdmdview Rust application and supporting scripts in the repository root. Primary code targets identified:
- Core: `src/main.rs`, `src/lib.rs`, `src/app.rs`, `src/window_state.rs`
- Rendering: `src/markdown_renderer.rs`, `src/table_support/{mod.rs,metrics.rs,column_spec.rs}`
- Assets/helpers: `src/emoji_assets.rs`, `src/emoji_catalog.rs`, `src/sample_files.rs`
- Build/Tooling: `build.rs`, `Cargo.toml`, `Cargo.lock`
- Ancillary Rust: `analyze_text.rs`, `navigation_tests_backup.rs`, `examples/gen_webp.rs`
- Tests/examples to consult for intent: markdown samples under `examples/` and `examples/regressions/`

Plan:
1) Repository context
   - Inspect `Cargo.toml` for crate setup, features, dependencies. Note edition, lint settings, binary target, build script usage.
   - Skim `README.md` for expected behavior/user-visible requirements that guide review.
2) Entry points and configuration
   - Review `build.rs` for resource embedding and platform assumptions.
   - Review `src/main.rs` and `src/lib.rs` for startup, CLI parsing, feature flags, panic handling.
3) Application state & UI
   - Deep read `src/app.rs`: event handling, file loading, navigation, zoom/fullscreen, clipboard, drag-drop, error handling. Trace keyboard shortcuts; verify egui update loop non-blocking; check concurrency and path handling.
   - Review `src/window_state.rs` for persistence, defaults, edge cases on invalid size/position.
4) Rendering pipeline
   - Analyze `src/markdown_renderer.rs`: parser configuration, table handling, code block rendering, image/webp handling, link behaviors, security (path validation), performance hotspots (allocation, cloning), error propagation, unit tests.
   - Analyze `src/table_support/*` for column width computation, wrap, alignment; confirm math correctness and overflow handling.
5) Content/assets helpers
   - Review `src/emoji_assets.rs` and `src/emoji_catalog.rs` for lookup correctness and fallbacks.
   - Review `src/sample_files.rs` for embedding and path safety.
6) Ancillary Rust files
   - Inspect `analyze_text.rs`, `navigation_tests_backup.rs`, and `examples/gen_webp.rs` for dead code, outdated logic, or hidden risks.
7) Tests and fixtures
   - Locate existing inline `#[cfg(test)]` blocks across files; evaluate coverage, reliability, and gaps. Check markdown examples/regressions for scenario coverage.
8) Quality checks
   - Look for `TODO`/`FIXME`, unwrap/expect usage outside tests, and potential panics. Assess error messages and user feedback paths.
   - Note performance or memory risks (large files, table layout complexity) and recommend profiling or guards.
9) Findings synthesis
   - Summarize issues (severity-order), risks, and suggested fixes/tests. Highlight quick wins vs. structural work.

Execution notes:
- Follow AGENTS.md guidance (anyhow::Result, avoid unwraps, keep egui non-blocking, validate paths).
- No network or external tools; rely on local code review.
