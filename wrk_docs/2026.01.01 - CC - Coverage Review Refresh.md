# Coverage Review (2026.01.01)

## Scope and Method
- Command (coverage): `cargo llvm-cov --no-default-features --ignore-filename-regex "target/llvm-cov-target"`
- Artifacts: `wrk_docs/coverage-latest.json`, `wrk_docs/coverage-latest-summary.json`, `wrk_docs/coverage-latest-missing.txt`
- Note: Coverage run used `--no-default-features` (QuickJS builds require a `patch` tool on PATH). Re-run with default features to cover embedded Mermaid once `patch` is available.

## Overall Coverage
- Lines: 98.09% (13445/13707)
- Functions: 96.77% (1109/1146)
- Regions: 96.69% (21373/22104)

## File-Level Line Coverage (Lowest First)
- `src/mermaid_renderer.rs`: 96.83% (12/378 missed)
- `src/markdown_renderer.rs`: 97.58% (177/7305 missed)
- `src/app.rs`: 98.26% (68/3908 missed)
- `src/main.rs`: 98.99% (3/296 missed)
- `src/table_support/column_spec.rs`: 99.26% (6/813 missed)
- `src/window_state.rs`: 99.34% (2/304 missed)
- `src/image_decode.rs`: 99.42% (1/171 missed)
- `src/emoji_assets.rs`: 100.00%
- `src/emoji_catalog.rs`: 100.00%
- `src/sample_files.rs`: 100.00%
- `src/table_support/metrics.rs`: 100.00%

## Hotspots and Missing Lines
- `src/mermaid_renderer.rs`: 245, 253, 335, 506, 767, 865, 2852, 2971 (error paths and less common renderer branches)
- `src/markdown_renderer.rs`: missing clusters around 800-899, 2700-2799, 3300-3499, 3400-3499, 4000-4099, 5600-5699 (parsing/table/render fallback branches)
- `src/app.rs`: missing clusters around 1000-1099, 1500-1699, 1800-1899, 2000-2199 (raw/edit/screenshot and UI flow edges)
- `src/table_support/column_spec.rs`: 265, 306, 523, 524 (remainder selection and emoji-like detection path)
- `src/window_state.rs`: 91, 99 (directory creation and file write)
- `src/main.rs`: 102 (screenshot input validation guard)
- `src/image_decode.rs`: 58 (post-decode size guard)

## Key Risks and Notes
- Embedded Mermaid is now default, but the current coverage run excludes QuickJS builds; coverage for the embedded renderer should be re-measured with default features once `patch` is available in PATH.
- The largest coverage gap is still `src/markdown_renderer.rs`; this file owns a significant portion of rendering logic and is the highest regression risk.
- `src/app.rs` gaps cluster in UI edge cases (screenshot, raw editing state transitions, and navigation flows).
