# Fix Plan â€” mdmdview (2025-11-21)

Scope: address the critical review items (mojibake, emoji pipeline, history duplication, Mermaid network default, unsafe link opening) plus clean documentation.

Plan:
1) **UI/text cleanup**
   - Replace corrupted strings in `src/app.rs` (menus, status bar, overlays, context menus) with clean ASCII/UTF-8.
   - Clean README and embedded sample markdown (`src/sample_files.rs`) to remove mojibake while keeping feature coverage.
2) **Emoji pipeline repair**
   - Standardize emoji keys to real Unicode; update `emoji_catalog.rs`, `emoji_assets.rs`, renderer handling, and tests.
3) **Navigation history correctness**
   - Remove double-history push on drag/drop and prevent reload from adding history entries; add regression tests.
4) **Mermaid/Kroki safety**
   - Default to offline: gate Kroki network jobs behind an opt-in env/flag; surface a clear UI note when disabled.
5) **Link safety**
   - Add scheme allowlist before calling `webbrowser::open`; show feedback for blocked schemes.
6) **Validation**
   - Update/extend tests for samples, emoji expansion, and history; run `cargo test`.

Deliverables: code fixes, updated docs, and passing test suite.
