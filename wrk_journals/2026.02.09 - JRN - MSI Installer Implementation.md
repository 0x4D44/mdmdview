# Journal: MSI Installer Implementation

**Date:** 2026-02-09
**Plan:** `wrk_docs/2026.02.09 - PLN - Windows MSI Installer.md`
**Design:** `wrk_docs/2026.02.09 - HLD - Windows MSI Installer V4.md`

---

## Progress Tracker

| Stage | Description | Status | Notes |
|-------|------------|--------|-------|
| 1 | License & Cargo metadata | Done | LICENSE, Cargo.toml updated |
| 2 | WiX scaffolding | Done | UpgradeCode: 2D62FD4A-A4F8-43CD-9D12-5930D4152D20 |
| 3 | Customize WXS | Done | File assoc, Start Menu, flat dir, WixUI_Minimal |
| 4 | Manual testing | Pending | MSI builds; needs manual install test by Arthur |
| 5 | CI/CD integration | Done | release.yml updated |
| 6 | Documentation | Done | CLAUDE.md updated |
| - | Code review | Done | Applied feedback: --locked, DiskPrompt cleanup |
| - | Test suite | PASS | 931 lib + 19 bin tests passed, 0 failed |

## Files Changed

| File | Change |
|------|--------|
| `LICENSE` | **New** -- MIT license, 2025, Martin Davidson |
| `Cargo.toml` | Updated: description, authors, license, [package.metadata.wix] |
| `wix/main.wxs` | **New** -- WiX source: flat install, file assoc, Start Menu, WixUI_Minimal |
| `wix/License.rtf` | **New** -- auto-generated MIT RTF for installer welcome page |
| `.github/workflows/release.yml` | Updated: WiX install, cargo-wix, MSI build, MSI artifacts |
| `CLAUDE.md` | Updated: MSI build commands, Windows Installer architecture section |

## Build Artifacts

- MSI: `target/wix/mdmdview-1.4.0-x86_64.msi`
- Build warning: ICE69 (LGHT1076) -- shortcut refs file from another component in same feature. Expected; harmless.

## Issues Encountered

1. **CNDL0062: Component/@Directory inside Directory** -- WiX disallows `Directory` attribute on a Component nested inside a Directory. Fix: nest component in target directory instead of using attribute.

2. **LGHT0094: Unresolved DiskPrompt** -- Removing `<Property Id='DiskPrompt'>` broke `<Media DiskPrompt='...'>` reference. Both removed together.

3. **PowerShell env var syntax** -- `$env:WIX` gets mangled through Bash tool. cargo-wix finds WiX via system-level env var regardless.

## Remaining

- [ ] Arthur manually tests the MSI (Stage 4): install, Start Menu, file association, ARP entry, uninstall
