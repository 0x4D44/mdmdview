# Journal - Coverage Review (2026.01.01)

## 2026.01.01
- Started coverage review using `cargo llvm-cov` (default features) with `--ignore-filename-regex "target/llvm-cov-target"`.
- Generated coverage artifacts: `wrk_docs/coverage-latest.json`, `wrk_docs/coverage-latest-missing.txt`, `wrk_docs/coverage-latest-summary.json`.
- Current src line coverage: 84.15% (9013/10711). Largest gap: `src/app.rs` at 59.95%.
- Next: write coverage report/plan and begin adding targeted tests to lift app.rs + markdown_renderer coverage.

- Wrote coverage report: `wrk_docs/2026.01.01 - CC - Coverage Report.md`.
- Wrote coverage improvement plan: `wrk_docs/2026.01.01 - CC - Coverage Improvement Plan.md`.

- Added menu helper functions and new app.rs tests covering screenshot helpers, shortcut handling, and UI render paths.
- Ran `cargo test app::tests -- --nocapture` (pass).

- Added main.rs CLI parse error-path tests and fixed expectations; reran targeted cargo test for main.rs.

- Refactored search dialog to use `update_search_results` helper and added tests for navigation keys, search clearing, and dynamic search update.
- Ran `cargo test app::tests::test_handle_shortcuts_navigation_keys -- --nocapture`.

- Fixed `navigate_forward` underflow by using `saturating_sub(1)`; this avoided a panic when history is empty and Alt+Right is pressed.
- Reran `cargo test app::tests::test_handle_shortcuts_sets_flags -- --nocapture`.

- Added markdown renderer tests for syntax mappings, emoji rendering, table image height, list block rendering, blockquote/list parsing, and tablebuilder width branches.
- Ran `cargo test markdown_renderer::tests::test_render_table_tablebuilder_scaled_down -- --nocapture`.

- Added markdown renderer tests for default construction, cache eviction edge case, inline code backtick escaping, HTML line breaks, and single-emoji emphasis; added app load-content parse error test and window_state registry override tests.
- Ran `cargo fmt --all` and `cargo test` to validate changes.
- Regenerated coverage artifacts; latest line coverage now 98.03% (13363/13632).

- Updated default build to include embedded Mermaid renderer (Cargo.toml default features).
- Updated README and sample content to reflect Mermaid embedded-by-default, with a --no-default-features opt-out and runtime toggle note.

- Updated CLAUDE.md build/architecture notes to match Mermaid embedded-by-default and the --no-default-features opt-out.

- Bumped package version in Cargo.toml to 1.0.2.

- Re-ran coverage with cargo llvm-cov --no-default-features after adding tests; updated wrk_docs/coverage-latest.json, wrk_docs/coverage-latest-missing.txt, and wrk_docs/coverage-latest-summary.json.
- Added tests for column spec remainder fallback and emoji-like detection, plus window state write/dir creation; coverage now ~98.09% lines (13445/13707).
- Wrote refreshed coverage report and plan: wrk_docs/2026.01.01 - CC - Coverage Review Refresh.md and wrk_docs/2026.01.01 - CC - Coverage Improvement Plan Refresh.md.
